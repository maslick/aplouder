!function(){class e{constructor(e){this.callback=e.callback||null,this.id=e.id||"ap-file-input",this.inputFileEl=document.getElementById(this.id),this.unknown="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAMAAAAOusbgAAABTVBMVEUAAAAAqv8AnOMAlOQAl+gAm+kAleoAmesAmOkAmukAmOkAmecAmucAmOcAmOgAmugAmegAmegAmOgAmegAmugAmekAmOkAmecAmucAmegAmegAmOgAmekAmukAmecAmegAmegAmegAmegAmegAmegAmegAmegAmegAmegAmegAmegAmegBmegCmugDmugEm+gFm+gHnOkInOkJnekOn+kao+ocpOsjp+skp+slqOsmqOsnqewoqewpqewtqusvq+syrOwzrew0rew1ruw2ruw3ruxDs+1EtO1Mt+5Rue5Xu++GzfKO0fOP0fOQ0fOR0vOS0vOT0/OU0/SV0/Sd1/Sk2fWl2vWm2vWn2/Wo2/Wp2/Wq3Pav3vay3/a44fe/5PfE5vjg8fnh8fri8vrj8vrk8vrn9Prr9frs9vvt9vvy+Pvz+Pv3+vz5+/z8/PzbC5gtAAAAK3RSTlMAAxITFhcYGVxdXl9gYWNljo+QkZKUlZaXmJmpqqvOz9DR6Onq6/Lz9Pr+b1G0hwAAAm1JREFUeAHt21dzUkEYh/GXE0VFgxpLoqACFiR7YjEWgxp7770XURNL3O9/6Y5ynIOvnuGZkd1c7HP7n53fLLeclayxtfVmy4y0VrNWSWSwVds6xkudqXLeXb/feKtdlazSZuO1iVIf9uw6uf87G+9VxbVin3+4XXbwdhOgSZGxTgi4k8g6E6SK7AgD16UZBt4le8PAu2U6DDwtJlDLHI5whCMc4QhHOMIRvjJfOM9dGxF89dvi+SK39/0GgIlr7ecL/5y7PWuBLMgtkLsfrCWyMNfJF/86n3IukgW4SlYukAW6ri+X1Hz6o7VQFuAqWblAFu46+fLAfOaTtVgW5mZyNzcfX/hzXrpOYODaRzMm1021uztjGLhABjBwqaxg4AIZwMAFMoCBy2X5Ty6WhbtchjB0oSzc5TKCuctk4S6XAcxdKgt3uTwEzF0uF8Cv1Nmls2bY5r6q02/TIeHDr9XZxXPDuj119t1RUwAzmbsaxjJ3AQxl7joYytwFMJa562AmY5fCXD4JXAUDWbnvketgLAMXwEAGLoCBDFwFc5m7Gubywjx3OWxm32j5RG4/BlwFwzu/PJSb04fAVTCSX+RdJz/groOhrF0n38eug7H8/KCa03vUdTCVnyk3k4nrYCRrN5PvMtfBTH6q3Ey+g1wHI/mJdn/Lt4GLYCc/PlAwp7eAi2BzZKZwTmeD/icR4QhHOMIRjnCEIxzhCIf76HdPGLgljTDwTqmHgetSCQOvliTUcwWZDAFvCfkkRar+4XH52Sbf7gb5VWnCr7uxJFnVtj+2PS65ylO+HtNtXSmDJZVaY9TPBxu1NUnm/QAjXOs62QO4CAAAAABJRU5ErkJggg==",this.Filez=[],this.numberOfFiles=0,this.slideNumber=null}init(){let i=this;e.aplouders.push(this);const t=`<div class="ap-droparea ${this.id}">\n`+'   <div class="ap-message">\n      <svg class="ap-box-icon" xmlns="http://www.w3.org/2000/svg" width="50" height="43" viewBox="0 0 50 43"><path d="M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"></path></svg>\n      <div><a href="#" class="ap-href"><strong>click</strong></a> to open the file Browser</div>\n   </div>\n   <div class="ap-gallery"></div>\n</div>\n'+`<div class="ap-modal ${this.id}" onclick="Aplouder.hideModal('${this.id}')">\n`+'   <div class="ap-modal-content"></div>\n</div>';this.inputFileEl.insertAdjacentHTML("afterend",t),this.inputFileEl.style.width="0.1px",this.inputFileEl.style.height="0.1px",this.inputFileEl.style.opacity="0",this.inputFileEl.style.overflow="hidden",this.inputFileEl.style.position="absolute",this.inputFileEl.style.zIndex="-1",this.initBrowseFilesButton(),this.inputFileEl.addEventListener("change",function(e){i.removeGallery(),i.processFiles(this.files,i.callback)},!1),window.addEventListener("keydown",function(t){27===t.keyCode&&e.hideModal(i.id),37===t.keyCode&&function(){if(null!==i.slideNumber){const t=i.slideNumber-1;-1!==t?e.currentSlide(i.id,t):e.currentSlide(i.id,Object.keys(i.Filez).length-1)}}(),39===t.keyCode&&function(){if(null!==i.slideNumber){const t=i.slideNumber+1;t!==Object.keys(i.Filez).length?e.currentSlide(i.id,t):e.currentSlide(i.id,0)}}()},!1)}processFiles(i,t){let l=this;for(let s=0;s<i.length;s++){let n=i[s];e.file2base64(n,function(i,s){e.scaleImage(s||l.unknown,120,120,function(n){const a={src:i,base64:s||l.unknown,thumb64:n,i:l.numberOfFiles++};e.drawImage(l.id,a),e.addSlide(l.id,a),l.Filez.push(a),null!=t&&t(a),l.initBrowseFilesButton()})})}}removeGallery(){document.querySelector(`.${this.id}.ap-droparea > .ap-gallery`).innerHTML="",document.querySelector(`.${this.id}.ap-modal > .ap-modal-content`).innerHTML="",this.Filez=[],this.numberOfFiles=0}initBrowseFilesButton(){let e=this;document.querySelector(`.${this.id}.ap-droparea > .ap-message`).onclick=function(){e.inputFileEl.click()}}static scaleImage(e,i,t,l){let s=new Image;s.crossOrigin="anonymous",s.onload=function(){var e=document.createElement("canvas"),n=e.getContext("2d");if(e.width=i,e.height=t,s.width===s.height)n.drawImage(this,0,0,i,t);else{let e=Math.min(s.width,s.height);s.width>s.height?n.drawImage(this,(s.width-e)/2,0,e,e,0,0,i,t):n.drawImage(this,0,(s.height-e)/2,e,e,0,0,i,t)}l(e.toDataURL("image/png"))},s.src=e}static file2base64(e,i){let t=new FileReader;["image/gif","image/jpeg","image/png"].includes(e.type)?(t.onload=function(t){i(e,t.target.result)},t.readAsDataURL(e)):i(e,null)}static drawImage(i,t){let l=`Aplouder.openModal('${i}'); Aplouder.currentSlide('${i}', ${t.i});`;document.querySelector(`.${i}.ap-droparea > .ap-gallery`).innerHTML+='<div class="ap-preview">   <div class="ap-image">       <img src="'+t.thumb64+'">   </div>   <div class="ap-overlay" onclick="'+l+'">       <div class="ap-details">           <div class="ap-size">'+e.formatFileSize(t.src.size)+'           </div>           <div class="ap-name">'+t.src.name+"           </div>       </div>   </div></div>"}static formatFileSize(e){return e<1e3?"< 1kB":e>=1e3&&e<=1e6?Math.round(e/1e3)+"kB":Math.round(e/1e6*10)/10+"Mb"}static addSlide(i,t){document.querySelector(`.${i}.ap-modal .ap-modal-content`).innerHTML+='<div class="ap-slides">   <img src="'+t.base64+'">   <div class="ap-slide-name">'+t.src.name+'   </div>   <div class="ap-slide-size">'+e.formatFileSize(t.src.size)+"   </div></div>"}static hideModal(i){document.querySelector(`.${i}.ap-modal`).style.display="none";let t=document.querySelectorAll(`.${i}.ap-modal > .ap-modal-content > .ap-slides`);for(let e=0;e<t.length;e++)t[e].style.display="none";document.getElementsByTagName("body")[0].style.overflow="auto",e.aplouders.filter(e=>e.id===i)[0].slideNumber=null}static openModal(e){document.querySelector(`.${e}.ap-modal`).style.display="block",document.getElementsByTagName("body")[0].style.overflow="hidden"}static currentSlide(i,t){let l=document.querySelectorAll(`.${i}.ap-modal > .ap-modal-content > .ap-slides`);for(let e=0;e<l.length;e++)l[e].style.display="none";l[t].style.display="block",e.aplouders.filter(e=>e.id===i)[0].slideNumber=t}}e.aplouders=[],"undefined"!=typeof module&&void 0!==module.exports?module.exports=e:window.Aplouder=e}();